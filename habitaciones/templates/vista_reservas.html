{% extends 'base.html' %}
{% load static %}

{% block title %}Reservas{% endblock %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/vista_clientes.css' %}">
<style>
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  h1 {
    font-size: 2rem;
    color: #343a40;
    margin-bottom: 10px;
  }

  .btn-crear,
  .btn-filtros,
  .btn-historial {
    padding: 12px 24px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 1.1rem;
    cursor: pointer;
    margin-bottom: 20px;
    transition: background-color 0.3s;
  }

  .btn-crear:hover,
  .btn-filtros:hover,
  .btn-historial:hover {
    background-color: #0056b3;
  }

  .tabla-reservas {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
  }

  .tabla-reservas th,
  .tabla-reservas td {
    padding: 14px 20px;
    text-align: center;
    border: 1px solid #ddd;
  }

  .tabla-reservas th {
    background-color: #007bff;
    color: white;
    font-size: 1.1rem;
  }

  .tabla-reservas td {
    font-size: 1rem;
  }

  .btn-ver {
    background-color: #17a2b8;
    color: white;
    padding: 6px 12px;
    border-radius: 5px;
    text-decoration: none;
  }

  .btn-ver:hover {
    background-color: #138496;
  }

  .btn-eliminar {
    background-color: #dc3545;
    color: white;
    padding: 6px 12px;
    border-radius: 5px;
  }

  .btn-eliminar:hover {
    background-color: #c82333;
  }

  .pagination {
    display: flex;
    justify-content: center;
    padding: 15px 0;
    list-style: none;
  }

  .pagination li {
    margin: 0 5px;
  }

  .pagination a,
  .pagination span {
    color: #007bff;
    padding: 8px 14px;
    text-decoration: none;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 1rem;
  }

  .pagination .active span {
    background-color: #007bff;
    color: white;
    border: 1px solid #007bff;
  }

  .pagination a:hover {
    background-color: #f1f1f1;
  }
</style>

<div class="container">
  <h1>Listado de Reservas</h1>
  <p>Bienvenido al panel de reservas.</p>

  <!-- Botón para ver el historial de reservas -->
  <a href="{% url 'historial_reservas' %}" class="btn btn-primary">Ver historial de reservas</a>

  <div class="reservas-lista">
    <table class="tabla-reservas">
      <thead>
        <tr>
          <th>ID</th>
          <th>Cliente</th>
          <th>Habitación</th>
          <th>Usuario</th>
          <th>Fecha Inicio</th>
          <th>Fecha Fin</th>
          <th>Cuenta</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% if reservas %}
        {% for reserva in reservas %}
        <tr>
          <td>{{ reserva.id }}</td>
          <td>{{ reserva.cliente.nombre }}</td>
          <td>{{ reserva.habitacion.numero }}</td>
          <td>{{ reserva.usuario.username }}</td>
          <td>{{ reserva.fecha_inicio }}</td>
          <td>{{ reserva.fecha_fin }}</td>
          <td>
            <a href="{% url 'ver_cuenta' reserva.habitacion.numero %}" class="btn-ver">Ver cuenta</a>
          </td>
          <td>
            <a href="{% url 'generar_pdf_cuenta' reserva.habitacion.numero %}" class="btn btn-warning">PDF</a>
            <a href="{% url 'realizar_cobro' reserva.habitacion.id %}" class="btn btn-success">Cobrar</a>
          </td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
          <td colspan="8" style="text-align: center; color: #dc3545;">No hay reservas pendientes por cobrar.</td>
        </tr>
        {% endif %}
      </tbody>
    </table>

    {% if reservas and reservas.has_other_pages %}
    <nav aria-label="Paginación">
      <ul class="pagination">
        {% if reservas.has_previous %}
        <li><a href="?page={{ reservas.previous_page_number }}">Anterior</a></li>
        {% endif %}

        {% for num in reservas.paginator.page_range %}
        {% if reservas.number == num %}
        <li class="active"><span>{{ num }}</span></li>
        {% else %}
        <li><a href="?page={{ num }}">{{ num }}</a></li>
        {% endif %}
        {% endfor %}

        {% if reservas.has_next %}
        <li><a href="?page={{ reservas.next_page_number }}">Siguiente</a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>
</div>

{% endblock %}